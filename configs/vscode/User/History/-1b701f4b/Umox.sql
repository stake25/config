SELECT  INFOPRO_DIV
  ,ROUTE_DATE
  ,ROUTE_NUM
  ,SEQUENCE
  ,REV_DIST_CODE
  ,SERVICE_CD
  ,ard.ACCOUNT
  ,ard.SITE
  ,ard.CONTAINER_GRP
FROM ROUTES.ACTIVE_ROUTE_DETAILS AS ard
LEFT JOIN PUP_TRAILER AS pt
  ON pt.XPK_ACTIVE_ROUTE_HEADER_ID = ard.XPK_ACTIVE_ROUTE_HEADER_ID
INNER JOIN ACTIVE_ROUTE_HEADER AS arh
  ON arh.PK_ACTIVE_ROUTE_HEADER_ID = ard.XPK_ACTIVE_ROUTE_HEADER_ID 
  AND INFOPRO_DIV IN $ division 
  AND pt.XPK_ACTIVE_ROUTE_DETAILS_ID1 IS NULL 
  AND pt.XPK_ACTIVE_ROUTE_DETAILS_ID2 IS NULL 
  AND ROUTE_FORMAT = 'I' 
  AND ard.IS_DELETED = 0 
  AND arh.STATUS = 'CREATE_COMPLETE' 
  AND EXTRA_SERVICE_TYPE IS NULL 
  AND VERSION = '1' 
  AND ard.EXTRA_SERVICE_TYPE IS NULL 
  AND arh.TRUCK_NUM IS NOT NULL 
  AND arh.EMP1_DETAILS IS NOT NULL 
  AND IS_SUSPENDED = 0 
  AND SERVICE_CD = 'DRT' 
  AND MONTH(ROUTE_DATE) = MONTH(CURRENT_DATE)
GROUP BY  ROUTE_NUM
  ,ROUTE_DATE
HAVING COUNT(PK_ACTIVE_ROUTE_DETAILS_ID) = '1' AND SUM(ard.quantity) = 1
LIMIT 1
